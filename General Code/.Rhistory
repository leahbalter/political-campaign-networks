save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v2', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\elSenGen', year, 'v2', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
rm(list = c('temp', 'elSenGen', 'senGenTrans'))
# Read the location of the data
# Assumes the filepath contains the year
# An easy way to copy the filepath:
# go to trans.txt, right click->properties
# copy the location field
filepath <- readline(prompt = "Enter the filepath to trans, cn, and cm .txt files")
year = gsub("\\D+","",filepath)
filepath_trans <- paste(filepath, '\\trans', year, '.txt', sep='', collapse = NULL)
filepath_cn <- paste(filepath, '\\cn', year, '.txt', sep='', collapse = NULL)
filepath_cm <- paste(filepath, '\\cm', year, '.txt', sep='', collapse = NULL)
# Filter the transactions
trans <- read.delim(filepath_trans, header = FALSE, sep = '|', quote = "")
trans <- trans[, c(1, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16)]
names(trans) <- c("sendID", "elType", "transCode", "recType", "recName", "recCity", "recState", "recZIP", "date", "amount", "recID")
trans <- subset(trans, transCode == "24K" | transCode == "24Z" | transCode == "24R" | transCode == "24E" | transCode == "24C" | transCode == "24H" | transCode == "24F")
date <- as.Date(sprintf('%08d', trans$date), '%m%d%Y')
trans$date <- date
save(trans, file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
# Filter the candidates
cn <- read.delim(filepath_cn, header = FALSE, sep = '|', quote = "")
cn <- cn[, c(1, 2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15)]
names(cn) = c("canID", "canName", "party", "elYear", "canState", "office", "district", "incumbent", "pccID", "cityAdd", "stateAdd", "zipAdd")
save(cn, file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
# Filter the committees
com <- read.delim(filepath_cm, header = FALSE, sep = '|', quote = "")
com <- com[, c(1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)]
names(com) = c("comID", "comName", "treasName", "city", "state", "zip", "comDes", "comType", "comParty", "filingFreq", "interestGroup", "connOrg", "canID")
save(com, file = paste(filepath ,'\\cm', year, '.rda', sep = "", collapse = NULL))
year = gsub("\\D+","",filepath)
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
date <- as.Date(sprintf('%08d', senGenTrans$date), '%m%d%Y')
senGenTrans$date <- date
rm(list = 'date')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v2', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\elSenGen', year, 'v2', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
rm(list = c('temp', 'elSenGen', 'senGenTrans'))
# Read the location of the data
# Assumes the filepath contains the year
# An easy way to copy the filepath:
# go to the folder, right click on the filepath bar
# copy the address
filepath <- readline(prompt = "Enter the filepath to trans, cn, and cm .txt files")
year = gsub("\\D+","",filepath)
filepath_trans <- paste(filepath, '\\trans', year, '.txt', sep='', collapse = NULL)
filepath_cn <- paste(filepath, '\\cn', year, '.txt', sep='', collapse = NULL)
filepath_cm <- paste(filepath, '\\cm', year, '.txt', sep='', collapse = NULL)
# Filter the transactions
trans <- read.delim(filepath_trans, header = FALSE, sep = '|', quote = "")
trans <- trans[, c(1, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16)]
names(trans) <- c("sendID", "elType", "transCode", "recType", "recName", "recCity", "recState", "recZIP", "date", "amount", "recID")
trans <- subset(trans, transCode == "24K" | transCode == "24Z" | transCode == "24R" | transCode == "24E" | transCode == "24C" | transCode == "24H" | transCode == "24F")
date <- as.Date(sprintf('%08d', trans$date), '%m%d%Y')
trans$date <- date
save(trans, file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
# Filter the candidates
cn <- read.delim(filepath_cn, header = FALSE, sep = '|', quote = "")
cn <- cn[, c(1, 2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15)]
names(cn) = c("canID", "canName", "party", "elYear", "canState", "office", "district", "incumbent", "pccID", "cityAdd", "stateAdd", "zipAdd")
save(cn, file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
# Filter the committees
com <- read.delim(filepath_cm, header = FALSE, sep = '|', quote = "")
com <- com[, c(1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)]
names(com) = c("comID", "comName", "treasName", "city", "state", "zip", "comDes", "comType", "comParty", "filingFreq", "interestGroup", "connOrg", "canID")
save(com, file = paste(filepath ,'\\cm', year, '.rda', sep = "", collapse = NULL))
year = gsub("\\D+","",filepath)
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
date <- as.Date(sprintf('%08d', senGenTrans$date), '%m%d%Y')
senGenTrans$date <- date
rm(list = 'date')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v2', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\elSenGen', year, 'v2', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
rm(list = c('temp', 'elSenGen', 'senGenTrans'))
library(ggplot2)
library(fiftystater)
library(tidyverse)
install.packages("ggplot")
install.packages("ggplot2")
library(ggplot2)
install.packages(c("fiftystater", "tidyverse"))
library(ggplot2)
library(fiftystater)
library(tidyverse)
data("fifty_states")
ggplot(data= crimes, aes(map_id = state)) +
geom_map(aes(fill = Assault),  color= "black", map = fifty_states) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(crimes, by = "state"), aes(x = long, y = lat, label = Assault ))+
scale_x_continuous(breaks = NULL) + scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
View(sen)
View(sen)
data("fifty_states")
library(ggplot2)
library(fiftystater)
library(tidyverse)
year <- readline(prompt = "Enter the year to plot")
filepath <- paste('..\\Data and Results\\', year, '\\stateNodes', year, '.txt', sep = "", collapse = NULL)
wpr <- read.delim(filepath, header = FALSE, sep = '|', quote = "")
filepath <- paste('..\\Data and Results\\', year, '\\stateNodes', year, '.csv', sep = "", collapse = NULL)
wpr <- read.delim(filepath, header = FALSE, sep = '|', quote = "")
data("fifty_states")
ggplot(data= wpr, aes(map_id = state)) +
geom_map(aes(fill = Assault),  color= "black", map = fifty_states) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(crimes, by = "state"), aes(x = long, y = lat, label = Assault ))+
scale_x_continuous(breaks = NULL) + scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
ggplot(data= wpr, aes(map_id = state)) +
geom_map(aes(fill = Assault),  color= "black", map = fifty_states) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(data, by = "state"), aes(x = long, y = lat, label = Assault ))+
scale_x_continuous(breaks = NULL) + scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
View(wpr)
View(wpr)
library(ggplot2)
library(fiftystater)
library(tidyverse)
year <- readline(prompt = "Enter the year to plot")
wpr <- read.csv(filepath, header = TRUE, sep = '|', quote = "")
View(wpr)
View(wpr)
year <- readline(prompt = "Enter the year to plot")
wpr <- read.csv(filepath, header = TRUE, sep = ',', quote = "")
View(wpr)
View(wpr)
data("fifty_states")
ggplot(data= wpr, aes(map_id = state)) +
geom_map(aes(fill = Assault),  color= "black", map = fifty_states) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(data, by = "state"), aes(x = long, y = lat, label = Assault ))+
scale_x_continuous(breaks = NULL) + scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
View(wpr)
View(wpr)
wpr <- data.frame(state = tolower(rownames(wPageRank)), wPageRank)
year <- readline(prompt = "Enter the year to plot")
results <- read.csv(filepath, header = TRUE, sep = ',', quote = "")
wpr <- data.frame(state = Name, wPageRank)
wpr <- subset(results, select=c("Name", "wPageRank"))
View(wpr)
View(wpr)
data("fifty_states")
ggplot(data= wpr, aes(map_id = state)) +
geom_map(aes(fill = Assault),  color= "black", map = fifty_states) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(data, by = "state"), aes(x = long, y = lat, label = Assault ))+
scale_x_continuous(breaks = NULL) + scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
wpr <- subset(results, select=c(state = "Name", "wPageRank"))
View(wpr)
View(wpr)
year <- readline(prompt = "Enter the year to plot")
results <- read.csv(filepath, header = TRUE, sep = ',', quote = "")
wpr <- subset(results, select=c(state = "Name", "wPageRank"))
ggplot(data= wpr, aes(map_id = Name)) +
geom_map(aes(fill = Assault),  color= "black", map = fifty_states) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(data, by = "state"), aes(x = long, y = lat, label = Assault ))+
scale_x_continuous(breaks = NULL) + scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
View(wpr)
View(wpr)
tbl <- state.x77 %>%
as_tibble(rownames = "state") %>%
bind_cols(state_name = state.abb) %>%
rename(value_x = Income) %>%
select(state_name, value_x)
View(tbl)
View(tbl)
tbl <- state.x77 %>%
as_tibble(rownames = "state") %>%
bind_cols(state_name = state.abb) %>%
rename(value_x = Income) %>%
select(state_name, value_x)
state_abbs <- tibble(state = str_to_lower(state.name), abb = state.abb)
tbl_m <- left_join(tbl, state_abbs, by = c("state_name" = "abb")) %>%
rename(id = state)
ggplot(tbl_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = value_x)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = value_x )
) +
scale_fill_viridis() +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
ggplot(tbl_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = value_x)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = value_x )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
ggplot(tbl_m) +
geom_map(aes(fill = Assault),  color= "black", map = fifty_states) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(data, by = "state"), aes(x = long, y = lat, label = Assault ))+
scale_x_continuous(breaks = NULL) + scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
ggplot(tbl_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = value_x)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = value_x )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
install.packages("mapproj")
ggplot(tbl_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = value_x)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = value_x )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
View(tbl)
View(tbl)
View(tbl_m)
View(tbl_m)
library(ggplot2)
library(fiftystater)
library(tidyverse)
year <- readline(prompt = "Enter the year to plot")
results <- read.csv(filepath, header = TRUE, sep = ',', quote = "")
wpr <- subset(results, select=c("Name", "wPageRank"))
state_abbs <- tibble(state = str_to_lower(state.name), abb = state.abb)
wpr_m <- left_join(wpr, state_abbs, by = c("Name" = "abb")) %>%
rename(id = state)
ggplot(wpr_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = value_x)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = value_x )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
ggplot(wpr_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = wPageRank)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = value_x )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
library(ggplot2)
library(fiftystater)
library(tidyverse)
year <- readline(prompt = "Enter the year to plot")
results <- read.csv(filepath, header = TRUE, sep = ',', quote = "")
wpr <- subset(results, select=c("Name", "wPageRank"))
state_abbs <- tibble(state = str_to_lower(state.name), abb = state.abb)
wpr_m <- left_join(wpr, state_abbs, by = c("Name" = "abb")) %>%
rename(id = state)
ggplot(wpr_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = wPageRank)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = Name )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
View(wpr_m)
View(wpr_m)
ggplot(wpr_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = wPageRank)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = "Name" )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
ggplot(wpr_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = wPageRank)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = Name )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
ggplot(wpr_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = wPageRank)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = wPageRank )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
ggplot(wpr_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = wPageRank)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat, label = wpr_m[['Name']] )
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
ggplot(wpr_m) +
geom_map(map = fifty_states, aes(map_id = id, fill = wPageRank)) +
expand_limits(x = fifty_states$long, y = fifty_states$lat) +
coord_map() +
geom_text(
data = fifty_states %>%
group_by(id) %>%
summarise(lat = mean(c(max(lat), min(lat))),
long = mean(c(max(long), min(long)))) %>%
mutate(state = id) %>%
left_join(tbl_m, by = c("state" = "id")),
aes(x = long, y = lat)
) +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = NULL) +
labs(x = "", y = "") + theme(legend.position = "bottom",
panel.background = element_blank())
