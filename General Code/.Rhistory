trans <- trans[, c(1, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16)]
names(trans) <- c("sendID", "elType", "transCode", "recType", "recName", "recCity", "recState", "recZIP", "date", "amount", "recID")
trans <- subset(trans, transCode == '24A' | transCode == '24N' | transCode == "24K" | transCode == "24Z" | transCode == "24R" | transCode == "24E" | transCode == "24C" | transCode == "24H" | transCode == "24F")
trans$date <- as.Date(sprintf('%08d', trans$date), '%m%d%Y')
save(trans, file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
# Filter the candidates
cn <- read.delim(filepath_cn, header = FALSE, sep = '|', quote = "")
cn <- cn[, c(1, 2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15)]
names(cn) = c("canID", "canName", "party", "elYear", "canState", "office", "district", "incumbent", "pccID", "cityAdd", "stateAdd", "zipAdd")
save(cn, file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
# Filter the committees
com <- read.delim(filepath_cm, header = FALSE, sep = '|', quote = "")
com <- com[, c(1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)]
names(com) = c("comID", "comName", "treasName", "city", "state", "zip", "comDes", "comType", "comParty", "filingFreq", "interestGroup", "connOrg", "canID")
save(com, file = paste(filepath ,'\\cm', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
date <- as.Date(sprintf('%08d', senGenTrans$date), '%m%d%Y')
senGenTrans$date <- date
rm(list = 'date')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v2', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\elSenGen', year, 'v2', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
rm(list = c('temp', 'elSenGen', 'senGenTrans'))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v3', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste(filepath, '\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
dir.create(file.path(paste('..\\Data and Results\\', year, sep = "", collapse = NULL), 'SenV3'))
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\SenV3\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
# Read the location of the data
# Assumes the filepath contains the year
# An easy way to copy the filepath:
# go to the folder, right click on the filepath bar
# copy the address
filepath <- readline(prompt = "Enter the filepath to trans, cn, and cm .txt files")
year = gsub("\\D+","",filepath)
filepath_trans <- paste(filepath, '\\trans', year, '.txt', sep='', collapse = NULL)
filepath_cn <- paste(filepath, '\\cn', year, '.txt', sep='', collapse = NULL)
filepath_cm <- paste(filepath, '\\cm', year, '.txt', sep='', collapse = NULL)
rawTrans <- read.delim(filepath_trans, header = FALSE, sep = '|')
save(rawTrans, file = paste(filepath, '\\rawTrans', year, '.rda', sep = "", collapse = NULL))
trans <- rawTrans
rm(list = 'rawTrans')
# Filter the transactions
trans <- trans[, c(1, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16)]
names(trans) <- c("sendID", "elType", "transCode", "recType", "recName", "recCity", "recState", "recZIP", "date", "amount", "recID")
trans <- subset(trans, transCode == '24A' | transCode == '24N' | transCode == "24K" | transCode == "24Z" | transCode == "24R" | transCode == "24E" | transCode == "24C" | transCode == "24H" | transCode == "24F")
trans$date <- as.Date(sprintf('%08d', trans$date), '%m%d%Y')
save(trans, file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
# Filter the candidates
cn <- read.delim(filepath_cn, header = FALSE, sep = '|', quote = "")
cn <- cn[, c(1, 2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15)]
names(cn) = c("canID", "canName", "party", "elYear", "canState", "office", "district", "incumbent", "pccID", "cityAdd", "stateAdd", "zipAdd")
save(cn, file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
# Filter the committees
com <- read.delim(filepath_cm, header = FALSE, sep = '|', quote = "")
com <- com[, c(1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)]
names(com) = c("comID", "comName", "treasName", "city", "state", "zip", "comDes", "comType", "comParty", "filingFreq", "interestGroup", "connOrg", "canID")
save(com, file = paste(filepath ,'\\cm', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
date <- as.Date(sprintf('%08d', senGenTrans$date), '%m%d%Y')
senGenTrans$date <- date
rm(list = 'date')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v2', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\elSenGen', year, 'v2', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
rm(list = c('temp', 'elSenGen', 'senGenTrans'))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v3', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste(filepath, '\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
dir.create(file.path(paste('..\\Data and Results\\', year, sep = "", collapse = NULL), 'SenV3'))
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\SenV3\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
# Read the location of the data
# Assumes the filepath contains the year
# An easy way to copy the filepath:
# go to the folder, right click on the filepath bar
# copy the address
filepath <- readline(prompt = "Enter the filepath to trans, cn, and cm .txt files")
year = gsub("\\D+","",filepath)
filepath_trans <- paste(filepath, '\\trans', year, '.txt', sep='', collapse = NULL)
filepath_cn <- paste(filepath, '\\cn', year, '.txt', sep='', collapse = NULL)
filepath_cm <- paste(filepath, '\\cm', year, '.txt', sep='', collapse = NULL)
rawTrans <- read.delim(filepath_trans, header = FALSE, sep = '|')
save(rawTrans, file = paste(filepath, '\\rawTrans', year, '.rda', sep = "", collapse = NULL))
trans <- rawTrans
rm(list = 'rawTrans')
# Filter the transactions
trans <- trans[, c(1, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16)]
names(trans) <- c("sendID", "elType", "transCode", "recType", "recName", "recCity", "recState", "recZIP", "date", "amount", "recID")
trans <- subset(trans, transCode == '24A' | transCode == '24N' | transCode == "24K" | transCode == "24Z" | transCode == "24R" | transCode == "24E" | transCode == "24C" | transCode == "24H" | transCode == "24F")
trans$date <- as.Date(sprintf('%08d', trans$date), '%m%d%Y')
save(trans, file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
# Filter the candidates
cn <- read.delim(filepath_cn, header = FALSE, sep = '|', quote = "")
cn <- cn[, c(1, 2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15)]
names(cn) = c("canID", "canName", "party", "elYear", "canState", "office", "district", "incumbent", "pccID", "cityAdd", "stateAdd", "zipAdd")
save(cn, file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
# Filter the committees
com <- read.delim(filepath_cm, header = FALSE, sep = '|', quote = "")
com <- com[, c(1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)]
names(com) = c("comID", "comName", "treasName", "city", "state", "zip", "comDes", "comType", "comParty", "filingFreq", "interestGroup", "connOrg", "canID")
save(com, file = paste(filepath ,'\\cm', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
date <- as.Date(sprintf('%08d', senGenTrans$date), '%m%d%Y')
senGenTrans$date <- date
rm(list = 'date')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v2', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\elSenGen', year, 'v2', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
rm(list = c('temp', 'elSenGen', 'senGenTrans'))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v3', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste(filepath, '\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
dir.create(file.path(paste('..\\Data and Results\\', year, sep = "", collapse = NULL), 'SenV3'))
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\SenV3\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
# Read the location of the data
# Assumes the filepath contains the year
# An easy way to copy the filepath:
# go to the folder, right click on the filepath bar
# copy the address
filepath <- readline(prompt = "Enter the filepath to trans, cn, and cm .txt files")
year = gsub("\\D+","",filepath)
filepath_trans <- paste(filepath, '\\trans', year, '.txt', sep='', collapse = NULL)
filepath_cn <- paste(filepath, '\\cn', year, '.txt', sep='', collapse = NULL)
filepath_cm <- paste(filepath, '\\cm', year, '.txt', sep='', collapse = NULL)
rawTrans <- read.delim(filepath_trans, header = FALSE, sep = '|')
save(rawTrans, file = paste(filepath, '\\rawTrans', year, '.rda', sep = "", collapse = NULL))
trans <- rawTrans
rm(list = 'rawTrans')
# Filter the transactions
trans <- trans[, c(1, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16)]
names(trans) <- c("sendID", "elType", "transCode", "recType", "recName", "recCity", "recState", "recZIP", "date", "amount", "recID")
trans <- subset(trans, transCode == '24A' | transCode == '24N' | transCode == "24K" | transCode == "24Z" | transCode == "24R" | transCode == "24E" | transCode == "24C" | transCode == "24H" | transCode == "24F")
trans$date <- as.Date(sprintf('%08d', trans$date), '%m%d%Y')
save(trans, file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
# Filter the candidates
cn <- read.delim(filepath_cn, header = FALSE, sep = '|', quote = "")
cn <- cn[, c(1, 2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15)]
names(cn) = c("canID", "canName", "party", "elYear", "canState", "office", "district", "incumbent", "pccID", "cityAdd", "stateAdd", "zipAdd")
save(cn, file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
# Filter the committees
com <- read.delim(filepath_cm, header = FALSE, sep = '|', quote = "")
com <- com[, c(1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)]
names(com) = c("comID", "comName", "treasName", "city", "state", "zip", "comDes", "comType", "comParty", "filingFreq", "interestGroup", "connOrg", "canID")
save(com, file = paste(filepath ,'\\cm', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
date <- as.Date(sprintf('%08d', senGenTrans$date), '%m%d%Y')
senGenTrans$date <- date
rm(list = 'date')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v2', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\elSenGen', year, 'v2', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
rm(list = c('temp', 'elSenGen', 'senGenTrans'))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v3', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste(filepath, '\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
dir.create(file.path(paste('..\\Data and Results\\', year, sep = "", collapse = NULL), 'SenV3'))
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\SenV3\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
# Read the location of the data
# Assumes the filepath contains the year
# An easy way to copy the filepath:
# go to the folder, right click on the filepath bar
# copy the address
filepath <- readline(prompt = "Enter the filepath to trans, cn, and cm .txt files")
year = gsub("\\D+","",filepath)
filepath_trans <- paste(filepath, '\\trans', year, '.txt', sep='', collapse = NULL)
filepath_cn <- paste(filepath, '\\cn', year, '.txt', sep='', collapse = NULL)
filepath_cm <- paste(filepath, '\\cm', year, '.txt', sep='', collapse = NULL)
rawTrans <- read.delim(filepath_trans, header = FALSE, sep = '|')
save(rawTrans, file = paste(filepath, '\\rawTrans', year, '.rda', sep = "", collapse = NULL))
trans <- rawTrans
rm(list = 'rawTrans')
# Filter the transactions
trans <- trans[, c(1, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16)]
names(trans) <- c("sendID", "elType", "transCode", "recType", "recName", "recCity", "recState", "recZIP", "date", "amount", "recID")
trans <- subset(trans, transCode == '24A' | transCode == '24N' | transCode == "24K" | transCode == "24Z" | transCode == "24R" | transCode == "24E" | transCode == "24C" | transCode == "24H" | transCode == "24F")
trans$date <- as.Date(sprintf('%08d', trans$date), '%m%d%Y')
save(trans, file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
# Filter the candidates
cn <- read.delim(filepath_cn, header = FALSE, sep = '|', quote = "")
cn <- cn[, c(1, 2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15)]
names(cn) = c("canID", "canName", "party", "elYear", "canState", "office", "district", "incumbent", "pccID", "cityAdd", "stateAdd", "zipAdd")
save(cn, file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
# Filter the committees
com <- read.delim(filepath_cm, header = FALSE, sep = '|', quote = "")
com <- com[, c(1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)]
names(com) = c("comID", "comName", "treasName", "city", "state", "zip", "comDes", "comType", "comParty", "filingFreq", "interestGroup", "connOrg", "canID")
save(com, file = paste(filepath ,'\\cm', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
date <- as.Date(sprintf('%08d', senGenTrans$date), '%m%d%Y')
senGenTrans$date <- date
rm(list = 'date')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v2', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\elSenGen', year, 'v2', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
rm(list = c('temp', 'elSenGen', 'senGenTrans'))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v3', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste(filepath, '\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
dir.create(file.path(paste('..\\Data and Results\\', year, sep = "", collapse = NULL), 'SenV3'))
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\SenV3\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
# Read the location of the data
# Assumes the filepath contains the year
# An easy way to copy the filepath:
# go to the folder, right click on the filepath bar
# copy the address
filepath <- readline(prompt = "Enter the filepath to trans, cn, and cm .txt files")
year = gsub("\\D+","",filepath)
filepath_trans <- paste(filepath, '\\trans', year, '.txt', sep='', collapse = NULL)
filepath_cn <- paste(filepath, '\\cn', year, '.txt', sep='', collapse = NULL)
filepath_cm <- paste(filepath, '\\cm', year, '.txt', sep='', collapse = NULL)
rawTrans <- read.delim(filepath_trans, header = FALSE, sep = '|')
save(rawTrans, file = paste(filepath, '\\rawTrans', year, '.rda', sep = "", collapse = NULL))
trans <- rawTrans
rm(list = 'rawTrans')
# Filter the transactions
trans <- trans[, c(1, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16)]
names(trans) <- c("sendID", "elType", "transCode", "recType", "recName", "recCity", "recState", "recZIP", "date", "amount", "recID")
trans <- subset(trans, transCode == '24A' | transCode == '24N' | transCode == "24K" | transCode == "24Z" | transCode == "24R" | transCode == "24E" | transCode == "24C" | transCode == "24H" | transCode == "24F")
trans$date <- as.Date(sprintf('%08d', trans$date), '%m%d%Y')
save(trans, file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
# Filter the candidates
cn <- read.delim(filepath_cn, header = FALSE, sep = '|', quote = "")
cn <- cn[, c(1, 2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15)]
# Read the location of the data
# Assumes the filepath contains the year
# An easy way to copy the filepath:
# go to the folder, right click on the filepath bar
# copy the address
filepath <- readline(prompt = "Enter the filepath to trans, cn, and cm .txt files")
year = gsub("\\D+","",filepath)
filepath_trans <- paste(filepath, '\\trans', year, '.txt', sep='', collapse = NULL)
filepath_cn <- paste(filepath, '\\cn', year, '.txt', sep='', collapse = NULL)
filepath_cm <- paste(filepath, '\\cm', year, '.txt', sep='', collapse = NULL)
rawTrans <- read.delim(filepath_trans, header = FALSE, sep = '|')
save(rawTrans, file = paste(filepath, '\\rawTrans', year, '.rda', sep = "", collapse = NULL))
trans <- rawTrans
rm(list = 'rawTrans')
# Filter the transactions
trans <- trans[, c(1, 4, 6, 7, 8, 9, 10, 11, 14, 15, 16)]
names(trans) <- c("sendID", "elType", "transCode", "recType", "recName", "recCity", "recState", "recZIP", "date", "amount", "recID")
trans <- subset(trans, transCode == '24A' | transCode == '24N' | transCode == "24K" | transCode == "24Z" | transCode == "24R" | transCode == "24E" | transCode == "24C" | transCode == "24H" | transCode == "24F")
trans$date <- as.Date(sprintf('%08d', trans$date), '%m%d%Y')
save(trans, file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
# Filter the candidates
cn <- read.delim(filepath_cn, header = FALSE, sep = '|', quote = "")
cn <- cn[, c(1, 2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15)]
names(cn) = c("canID", "canName", "party", "elYear", "canState", "office", "district", "incumbent", "pccID", "cityAdd", "stateAdd", "zipAdd")
save(cn, file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
# Filter the committees
com <- read.delim(filepath_cm, header = FALSE, sep = '|', quote = "")
com <- com[, c(1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15)]
names(com) = c("comID", "comName", "treasName", "city", "state", "zip", "comDes", "comType", "comParty", "filingFreq", "interestGroup", "connOrg", "canID")
save(com, file = paste(filepath ,'\\cm', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
date <- as.Date(sprintf('%08d', senGenTrans$date), '%m%d%Y')
senGenTrans$date <- date
rm(list = 'date')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v2', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\elSenGen', year, 'v2', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
rm(list = c('temp', 'elSenGen', 'senGenTrans'))
load(file = paste(filepath ,'\\cn', year, '.rda', sep = "", collapse = NULL))
load(file = paste(filepath ,'\\trans', year, '.rda', sep = "", collapse = NULL))
sen <- subset(cn, office == "S")
sen <- subset(sen, elYear == year)
rm (list = 'cn')
senGenTrans <- trans
rm(list = 'trans')
senGenTrans <- subset(senGenTrans, recID %in% sen$canID | recID %in% sen$pccID)
senGenTrans <- subset(senGenTrans, recID != "")
senGenTrans <- subset(senGenTrans, amount > 0)
senGenTrans <- subset(senGenTrans, elType == 'G' | elType == paste('G', year, sep = "", collaspe = NULL))
pcc <- subset(senGenTrans, recID %in% sen$pccID)
pccState <- sen[match(pcc$recID, sen$pccID),]$canState
pcc$state = pccState
can <- subset(senGenTrans, recID %in% sen$canID)
canState <- sen[match(can$recID, sen$canID),]$canState
can$state = canState
senGenTrans <- rbind(pcc, can)
save(senGenTrans, file = paste(filepath, '\\senGenTrans', year, 'v3', '.rda', sep = "", collapse = NULL))
rm(list = c('pcc', 'pccState', 'can', 'canState'))
temp <- data.frame(senGenTrans$sendID, senGenTrans$amount, senGenTrans$state)
names(temp) = c("sendID", "amount", "state")
elSenGen <- aggregate(amount ~ sendID + state, temp, sum)
write.table(elSenGen, file = paste(filepath, '\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
dir.create(file.path(paste('..\\Data and Results\\', year, sep = "", collapse = NULL), 'SenV3'))
write.table(elSenGen, file = paste('..\\Data and Results\\', year, '\\SenV3\\elSenGen', year, 'v3', '.txt', sep = "", collapse = NULL), row.names = FALSE, col.names = TRUE, quote = FALSE)
